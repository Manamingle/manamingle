<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description" content="Talk to strangers anonymously. Safe and monitored video/text chat for speakers worldwide.">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  
  <!-- Simplified CSP -->
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self' https://cdn.socket.io https://fonts.googleapis.com;
  script-src 'self' 'unsafe-inline' https://cdn.socket.io;
  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
  font-src 'self' https://fonts.gstatic.com;
  connect-src 'self' https://manamingle.site wss://manamingle.site https://cdn.socket.io;
  img-src 'self' data: https:;
  media-src 'self' blob:;
  frame-src 'none';
  object-src 'none';
">

  
  <title>Mana Mingle - Professional Stranger Chat</title>
  
  <meta name="theme-color" content="#0066cc">
  <script>
    (function(){
      var prod = /manamingle\.site$/i.test(location.hostname);
      if (prod) {
        var l = document.createElement('link');
        l.rel = 'manifest';
        l.href = '/manifest.json';
        document.head.appendChild(l);
        var p = document.createElement('script');
        p.src = '/js/pwa-register.js';
        p.defer = true;
        document.head.appendChild(p);
        var a = document.createElement('script');
        a.src = '/js/ad-manager.js';
        a.defer = true;
        document.head.appendChild(a);
      }
    })();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #0066cc;
      --primary-dark: #0052a3;
      --secondary: #00c853;
      --accent: #7b1fa2;
      --dark: #0a192f;
      --light: #f8fafc;
      --gray: #64748b;
      --gray-dark: #334155;
      --success: #00c853;
      --warning: #ff9800;
      --danger: #f44336;
      --border: rgba(255, 255, 255, 0.1);
      --card-bg: rgba(255, 255, 255, 0.05);
      --gradient: linear-gradient(135deg, #0066cc, #00c853);
    }

    [data-theme="light"] {
      --dark: #f0f4f8;
      --light: #0f172a;
      --card-bg: rgba(255, 255, 255, 0.85);
      --border: rgba(0, 0, 0, 0.1);
      --gray: #475569;
      --gray-dark: #e2e8f0;
    }

    /* Theme Toggle */
    .theme-toggle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      color: var(--light);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-left: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: rotate(30deg);
      border-color: var(--primary);
    }

    /* Scroll Animation Classes */
    .reveal-on-scroll {
      opacity: 0;
      transform: translateY(40px);
      transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
    }
    .reveal-on-scroll.is-visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* Typing Cursor */
    .typing-cursor::after {
      content: '|';
      display: inline-block;
      margin-left: 2px;
      animation: blink 1s step-start infinite;
      color: var(--primary);
    }
    @keyframes blink { 50% { opacity: 0; } }
    
    /* Loading Overlay for Cards */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: inherit;
      z-index: 10;
      backdrop-filter: blur(2px);
      animation: fadeIn 0.3s ease;
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    /* iOS Input Zoom Fix */
    @media screen and (-webkit-min-device-pixel-ratio: 0) {
      select, textarea, input {
        font-size: 16px !important;
      }
    }
    
    /* ===== BASE STYLES ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    html {
      scroll-behavior: smooth;
      height: 100dvh;
      overflow-x: hidden;
    }

    body {
      margin: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--dark);
      color: var(--light);
      min-height: 100dvh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
      -webkit-text-size-adjust: 100%;
    }

    /* ===== ANIMATED BACKGROUND ===== */
    .background-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      overflow: hidden;
    }

    .gradient-orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.3;
      animation: floatOrb 20s ease-in-out infinite;
    }

    .orb-1 {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, var(--primary), transparent 70%);
      top: 10%;
      left: 5%;
      animation-delay: 0s;
    }

    .orb-2 {
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, var(--accent), transparent 70%);
      bottom: 10%;
      right: 10%;
      animation-delay: -5s;
      animation-duration: 25s;
    }

    .orb-3 {
      width: 350px;
      height: 350px;
      background: radial-gradient(circle, var(--secondary), transparent 70%);
      top: 50%;
      left: 60%;
      animation-delay: -10s;
      animation-duration: 30s;
    }

    @keyframes floatOrb {
      0%, 100% {
        transform: translate(0, 0) scale(1);
      }
      25% {
        transform: translate(50px, -30px) scale(1.1);
      }
      50% {
        transform: translate(-30px, 40px) scale(0.9);
      }
      75% {
        transform: translate(40px, 30px) scale(1.05);
      }
    }

    /* Particle background */
    .particles {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .particle {
      position: absolute;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: floatParticle 15s linear infinite;
    }

    @keyframes floatParticle {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
      }
    }

    /* ===== NAVBAR ===== */
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(20px);
      background: rgba(10, 25, 47, 0.9);
      border-bottom: 1px solid var(--border);
      padding: 0 20px;
      padding-top: env(safe-area-inset-top);
      padding-left: max(20px, env(safe-area-inset-left));
      padding-right: max(20px, env(safe-area-inset-right));
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 70px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
    }

    .brand-logo {
      width: 40px;
      height: 40px;
      background: var(--gradient);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: white;
      animation: logoGlow 3s ease-in-out infinite;
    }

    .brand-logo-img {
      width: 45px;
      height: 45px;
      border-radius: 10px;
      object-fit: cover;
      animation: logoGlow 3s ease-in-out infinite;
    }

    @keyframes logoGlow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 102, 204, 0.5);
      }
      50% {
        box-shadow: 0 0 30px rgba(0, 102, 204, 0.8);
      }
    }

    .brand-text {
      font-size: 1.5rem;
      font-weight: 700;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .nav-stats {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stat-pill {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      color: var(--light);
      font-weight: 500;
      transition: all 0.3s ease;
      animation: slideInRight 0.5s ease-out;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .stat-pill:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .stat-pill.online .indicator {
      width: 8px;
      height: 8px;
      background: var(--success);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .stat-pill.coins {
      background: rgba(255, 193, 7, 0.1);
      border-color: rgba(255, 193, 7, 0.3);
      color: #ffc107;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
    }

    .stat-pill.coins:hover {
      background: rgba(255, 193, 7, 0.2);
      transform: translateY(-2px);
    }

    .stat-pill.coins span:first-child {
      cursor: pointer;
      display: inline-block;
      transition: transform 0.3s ease;
    }

    .stat-pill.coins:hover span:first-child {
      transform: scale(1.15);
    }

    .monetize-section { margin-top: 10px; }
    .monetize-controls {
      margin: 10px auto 0;
      max-width: 1000px;
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
    }

    @keyframes coinClick {
      0% { transform: scale(1); }
      25% { transform: scale(1.3); }
      50% { transform: scale(1.2); }
      75% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }

    @keyframes shakeDenied {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
      20%, 40%, 60%, 80% { transform: translateX(8px); }
    }

    /* Notification Bell */
    .notification-bell {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: slideInRight 0.5s ease-out;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .notification-bell:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      border-color: var(--primary);
    }

    .notification-bell.active {
      background: rgba(0, 102, 204, 0.2);
      border-color: var(--primary);
    }

    .bell-icon {
      font-size: 1.3rem;
      transition: transform 0.3s ease;
      position: relative;
    }

    .notification-bell:hover .bell-icon {
      animation: bellBounce 0.6s ease-in-out;
    }

    @keyframes bellBounce {
      0%, 100% {
        transform: translateY(0) scale(1);
        filter: drop-shadow(0 0 0px rgba(0, 102, 204, 0));
      }
      25% {
        transform: translateY(-8px) scale(1.15);
        filter: drop-shadow(0 4px 8px rgba(0, 102, 204, 0.6));
      }
      50% {
        transform: translateY(-4px) scale(1.1);
        filter: drop-shadow(0 2px 4px rgba(0, 102, 204, 0.4));
      }
      75% {
        transform: translateY(-6px) scale(1.12);
        filter: drop-shadow(0 3px 6px rgba(0, 102, 204, 0.5));
      }
    }

    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--danger);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 600;
      border: 2px solid var(--dark);
      animation: badgePop 0.3s ease-out;
      transition: all 0.3s ease;
    }

    .notification-badge.hidden {
      display: none;
    }

    @keyframes badgePop {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      50% {
        transform: scale(1.2);
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* Notification Dropdown */
    .notification-dropdown {
      position: absolute;
      top: calc(100% + 10px);
      right: 0;
      width: 380px;
      max-height: 500px;
      background: rgba(10, 25, 47, 0.98);
      border: 1px solid var(--border);
      border-radius: 16px;
      backdrop-filter: blur(20px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px) scale(0.95);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 10000;
      overflow: hidden;
    }

    .notification-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0) scale(1);
      animation: dropdownSlide 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes dropdownSlide {
      0% {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .notification-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 102, 204, 0.1);
    }

    .notification-header h3 {
      font-size: 1.2rem;
      font-weight: 600;
      margin: 0;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .clear-all-btn {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      color: var(--gray);
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .clear-all-btn:hover {
      background: rgba(244, 67, 54, 0.1);
      border-color: var(--danger);
      color: var(--danger);
    }

    .notification-list {
      max-height: 400px;
      overflow-y: auto;
      padding: 10px;
    }

    .notification-list::-webkit-scrollbar {
      width: 6px;
    }

    .notification-list::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    .notification-list::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 3px;
    }

    .notification-item {
      padding: 15px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: notificationSlideIn 0.4s ease-out;
      position: relative;
      overflow: hidden;
    }

    .notification-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: var(--primary);
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }

    .notification-item:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(5px);
      border-color: var(--primary);
    }

    .notification-item:hover::before {
      transform: scaleY(1);
    }

    .notification-item.read {
      opacity: 0.6;
    }

    @keyframes notificationSlideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .notification-content {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .notification-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
      animation: iconPulse 2s ease-in-out infinite;
    }

    @keyframes iconPulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.1);
      }
    }

    .notification-text {
      flex: 1;
    }

    .notification-message {
      color: var(--light);
      font-size: 0.95rem;
      margin-bottom: 5px;
      line-height: 1.4;
    }

    .notification-time {
      color: var(--gray);
      font-size: 0.8rem;
    }

    .notification-empty {
      padding: 40px 20px;
      text-align: center;
      color: var(--gray);
    }

    .notification-empty-icon {
      font-size: 3rem;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    .notification-empty-text {
      font-size: 1rem;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.7;
        transform: scale(1.2);
      }
    }

    /* ===== MAIN CONTENT ===== */
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    /* ===== HERO SECTION ===== */
    .hero-section {
      text-align: center;
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .hero-badge {
      display: inline-block;
      background: rgba(0, 102, 204, 0.2);
      color: var(--primary);
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 20px;
      border: 1px solid rgba(0, 102, 204, 0.3);
      animation: badgeFloat 4s ease-in-out infinite;
    }

    @keyframes badgeFloat {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-5px);
      }
    }

    .hero-title {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 20px;
      background: linear-gradient(135deg, var(--light), var(--primary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: titleGlow 3s ease-in-out infinite;
    }

    @keyframes titleGlow {
      0%, 100% {
        text-shadow: 0 0 20px rgba(0, 102, 204, 0.3);
      }
      50% {
        text-shadow: 0 0 30px rgba(0, 102, 204, 0.5);
      }
    }

    .hero-subtitle {
      font-size: 1.2rem;
      color: var(--gray);
      max-width: 600px;
      margin: 0 auto 40px;
      line-height: 1.6;
    }

    /* ===== CHAT BUTTONS ===== */
    .chat-section {
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out 0.2s both;
    }

    .chat-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .chat-card {
      /* Liquid Glass Base */
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(25px) saturate(150%);
      -webkit-backdrop-filter: blur(25px) saturate(150%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      border-left: 1px solid rgba(255, 255, 255, 0.4);
      border-radius: 24px;
      padding: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 
        0 10px 40px -10px rgba(0, 0, 0, 0.3),
        inset 0 0 20px rgba(255, 255, 255, 0.05);
      
      /* The Liquid Slide Gradient */
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.05) 30%,
        rgba(255, 255, 255, 0.2) 45%,
        rgba(255, 255, 255, 0.4) 50%,
        rgba(255, 255, 255, 0.2) 55%,
        rgba(255, 255, 255, 0.05) 70%,
        rgba(255, 255, 255, 0) 100%
      );
      background-size: 200% 100%;
      background-position: 150% 0;
      
      transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
      
      animation: cardFloat 6s ease-in-out infinite;
      will-change: transform, background-position;
      transform: translateZ(0);
    }

    .chat-card:nth-child(1) { animation-delay: 0s; }
    .chat-card:nth-child(2) { animation-delay: 2s; }
    .chat-card:nth-child(3) { animation-delay: 4s; }

    @keyframes cardFloat {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    /* Old pseudo-element removed/disabled */
    .chat-card::before {
      display: none;
    }

    .chat-card:hover::before {
      display: none;
    }

    .chat-card:hover {
      /* Trigger the slide */
      background-position: -50% 0;
      transform: translateY(-8px) scale(1.02);
      border-color: rgba(255, 255, 255, 0.6);
      box-shadow: 
        0 20px 50px -12px rgba(0, 102, 204, 0.5),
        inset 0 0 30px rgba(255, 255, 255, 0.2);
    }

    /* Inline popup ads on cards */
    .mm-card-ad {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.45);
      border: 1px solid var(--border);
      border-radius: clamp(16px, 3vw, 24px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      color: var(--light);
      z-index: 5;
      overflow: hidden;
      animation: mm-slide-in .25s ease-out;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    @keyframes mm-slide-in { from { transform: translateY(-8px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .mm-card-ad .mm-ad-header {
      position: absolute; top: 10px; left: 10px; right: 10px;
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 12px; border: 1px solid var(--border);
      border-radius: 12px; background: rgba(0,0,0,0.4);
      font-weight: 700; font-size: clamp(0.8rem, 2.5vw, 0.95rem);
    }
    .mm-card-ad .mm-ad-close {
      width: clamp(22px, 6vw, 26px); height: clamp(22px, 6vw, 26px); border-radius: 8px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.08); color: var(--light);
      display: flex; align-items: center; justify-content: center; cursor: pointer;
      transition: transform .2s ease, background .2s ease;
    }
    .mm-card-ad .mm-ad-close:hover { transform: scale(1.05); background: rgba(255,255,255,0.12); }
    .mm-card-ad .mm-ad-body { padding: clamp(12px, 3vw, 16px); display: flex; gap: clamp(10px, 3vw, 14px); align-items: center; font-size: clamp(0.9rem, 2.8vw, 1rem); opacity: .95; justify-content: center; }
    .mm-card-ad .mm-ad-thumb { width: clamp(48px, 12vw, 64px); height: clamp(48px, 12vw, 64px); border-radius: 12px; background: linear-gradient(135deg, rgba(0,102,204,.3), rgba(0,209,154,.3)); position: relative; }
    .mm-card-ad .mm-shimmer::after { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); animation: mm-shimmer 1.4s infinite; }
    @keyframes mm-shimmer { from { transform: translateX(-100%); } to { transform: translateX(100%); } }

    /* Inline page ad slots for free spaces */
    .mm-inline-slot {
      width: 100%;
      max-width: 1000px;
      min-height: 90px;
      margin: 24px auto;
      background: rgba(255,255,255,0.06);
      border: 1px dashed rgba(255,255,255,0.2);
      border-radius: 14px;
      display: flex; align-items: center; justify-content: center;
      color: var(--light);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    .mm-inline-slot.mm-shimmer::after { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent); animation: mm-shimmer 1.8s infinite; }

    .chat-icon {
      font-size: 3rem;
      margin-bottom: 20px;
      animation: iconBounce 2s ease-in-out infinite;
    }

    @keyframes iconBounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    .chat-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .chat-desc {
      color: var(--gray);
      font-size: 0.95rem;
      line-height: 1.5;
    }

    /* ===== INTERESTS SECTION ===== */
    .interests-section {
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out 0.4s both;
    }

    .section-title {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--light), var(--primary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .section-subtitle {
      color: var(--gray);
      margin-bottom: 30px;
    }

    .interests-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      animation: containerGlow 6s ease-in-out infinite;
    }

    @keyframes containerGlow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 102, 204, 0.1);
      }
      50% {
        box-shadow: 0 0 30px rgba(0, 102, 204, 0.2);
      }
    }

    .interests-input {
      position: relative;
      margin-bottom: 20px;
    }

    .interests-input input {
      width: 100%;
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid var(--border);
      border-radius: 12px;
      color: var(--light);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .interests-input input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
    }

    .interests-display {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
      min-height: 50px;
    }

    .interest-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 20px;
      /* Liquid Glass Base - Blue Tint */
      background: rgba(0, 102, 204, 0.15);
      backdrop-filter: blur(15px) saturate(120%);
      -webkit-backdrop-filter: blur(15px) saturate(120%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      border-left: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 30px;
      color: var(--light);
      font-size: 0.9rem;
      box-shadow: 
        0 4px 15px rgba(0, 102, 204, 0.2),
        inset 0 0 10px rgba(255, 255, 255, 0.1);
      
      /* Liquid Slide Gradient */
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.05) 30%,
        rgba(255, 255, 255, 0.3) 45%,
        rgba(255, 255, 255, 0.5) 50%,
        rgba(255, 255, 255, 0.3) 55%,
        rgba(255, 255, 255, 0.05) 70%,
        rgba(255, 255, 255, 0) 100%
      );
      background-size: 200% 100%;
      background-position: 150% 0;

      animation: tagPop 0.3s ease-out;
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      overflow: hidden;
    }

    @keyframes tagPop {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .interest-tag:hover {
      background-position: -50% 0;
      transform: translateY(-3px) scale(1.05);
      border-color: rgba(255, 255, 255, 0.6);
      box-shadow: 
        0 8px 25px -5px rgba(0, 102, 204, 0.5),
        inset 0 0 15px rgba(255, 255, 255, 0.2);
    }

    .interest-tag .remove {
      cursor: pointer;
      font-size: 1.2rem;
      line-height: 1;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .interest-tag .remove:hover {
      opacity: 1;
    }

    .interests-suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }

    .suggestion {
      padding: 8px 20px;
      /* Liquid Glass Base */
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(15px) saturate(120%);
      -webkit-backdrop-filter: blur(15px) saturate(120%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: 1px solid rgba(255, 255, 255, 0.4);
      border-left: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 30px;
      color: var(--gray);
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.1),
        inset 0 0 10px rgba(255, 255, 255, 0.05);
      
      /* Liquid Slide Gradient */
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.05) 30%,
        rgba(255, 255, 255, 0.2) 45%,
        rgba(255, 255, 255, 0.3) 50%,
        rgba(255, 255, 255, 0.2) 55%,
        rgba(255, 255, 255, 0.05) 70%,
        rgba(255, 255, 255, 0) 100%
      );
      background-size: 200% 100%;
      background-position: 150% 0;
      
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      animation: suggestionSlide 0.5s ease-out;
      position: relative;
      overflow: hidden;
      will-change: transform, background-position;
    }

    .suggestion:hover {
      color: var(--light);
      background-position: -50% 0;
      transform: translateY(-3px) scale(1.05);
      border-color: rgba(255, 255, 255, 0.5);
      box-shadow: 
        0 8px 25px -5px rgba(0, 102, 204, 0.4),
        inset 0 0 15px rgba(255, 255, 255, 0.2);
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    /* ===== FEATURES SECTION ===== */
    .features-section {
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out 0.6s both;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-top: 40px;
    }

    .feature-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      transition: all 0.3s ease;
      animation: featureSlide 0.5s ease-out;
    }

    @keyframes featureSlide {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .feature-card:hover {
      transform: translateY(-5px);
      border-color: var(--primary);
      box-shadow: 0 20px 40px rgba(0, 102, 204, 0.1);
    }

    .feature-icon {
      font-size: 2.5rem;
      margin-bottom: 20px;
      animation: iconGlow 3s ease-in-out infinite;
    }

    @keyframes iconGlow {
      0%, 100% {
        transform: scale(1);
        filter: drop-shadow(0 0 5px rgba(0, 102, 204, 0.3));
      }
      50% {
        transform: scale(1.1);
        filter: drop-shadow(0 0 15px rgba(0, 102, 204, 0.6));
      }
    }

    .feature-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .feature-desc {
      color: var(--gray);
      line-height: 1.6;
    }

    /* ===== STEPS SECTION ===== */
    .steps-section {
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out 0.8s both;
    }

    .steps-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin-top: 40px;
    }

    .step {
      position: relative;
      padding: 30px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      text-align: center;
      transition: all 0.3s ease;
      animation: stepPulse 4s ease-in-out infinite;
    }

    .step:nth-child(1) { animation-delay: 0s; }
    .step:nth-child(2) { animation-delay: 1s; }
    .step:nth-child(3) { animation-delay: 2s; }

    @keyframes stepPulse {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 102, 204, 0.1);
      }
      50% {
        box-shadow: 0 0 30px rgba(0, 102, 204, 0.2);
      }
    }

    .step-number {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 40px;
      background: var(--gradient);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 1.2rem;
      animation: numberGlow 2s ease-in-out infinite;
    }

    @keyframes numberGlow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 102, 204, 0.5);
      }
      50% {
        box-shadow: 0 0 30px rgba(0, 102, 204, 0.8);
      }
    }

    .step-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin: 20px 0 10px;
    }

    .step-desc {
      color: var(--gray);
      line-height: 1.6;
    }

    /* ===== SAFETY NOTICE ===== */
    .safety-section {
      margin-bottom: 60px;
      animation: fadeInUp 1s ease-out 1s both;
    }

    .safety-card {
      background: rgba(255, 152, 0, 0.1);
      border: 1px solid rgba(255, 152, 0, 0.3);
      border-radius: 16px;
      padding: 30px;
      display: flex;
      align-items: center;
      gap: 20px;
      animation: safetyPulse 3s ease-in-out infinite;
    }

    @keyframes safetyPulse {
      0%, 100% {
        box-shadow: 0 0 20px rgba(255, 152, 0, 0.1);
      }
      50% {
        box-shadow: 0 0 30px rgba(255, 152, 0, 0.2);
      }
    }

    .safety-icon {
      font-size: 2.5rem;
      animation: warningPulse 2s ease-in-out infinite;
    }

    @keyframes warningPulse {
      0%, 100% {
        transform: scale(1) translateY(0);
        filter: drop-shadow(0 0 8px rgba(255, 152, 0, 0.4));
      }
      25% {
        transform: scale(1.15) translateY(-5px);
        filter: drop-shadow(0 5px 15px rgba(255, 152, 0, 0.7));
      }
      50% {
        transform: scale(1.1) translateY(-3px);
        filter: drop-shadow(0 3px 12px rgba(255, 152, 0, 0.6));
      }
      75% {
        transform: scale(1.12) translateY(-4px);
        filter: drop-shadow(0 4px 13px rgba(255, 152, 0, 0.65));
      }
    }

    .safety-content h3 {
      color: #ff9800;
      margin-bottom: 10px;
      font-size: 1.3rem;
    }

    .safety-content p {
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.6;
    }

    /* ===== FOOTER ===== */
    footer {
      background: rgba(10, 25, 47, 0.9);
      border-top: 1px solid var(--border);
      padding: 40px 20px;
      margin-top: 60px;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      text-align: center;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 30px;
      margin-bottom: 30px;
    }

    .footer-links a {
      color: var(--gray);
      text-decoration: none;
      transition: color 0.3s ease;
      position: relative;
    }

    .footer-links a:hover {
      color: var(--primary);
    }

    .footer-links a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--primary);
      transition: width 0.3s ease;
    }

    .footer-links a:hover::after {
      width: 100%;
    }

    .copyright {
      color: var(--gray);
      font-size: 0.9rem;
    }

    /* ===== AGE VERIFICATION MODAL ===== */
    .age-verification-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      z-index: 99999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
    }

    .age-verification-overlay.show {
      pointer-events: auto;
    }

    .age-verification-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .age-verification-modal {
      background: linear-gradient(135deg, rgba(10, 25, 47, 0.98), rgba(10, 25, 47, 0.95));
      border: 2px solid var(--primary);
      border-radius: 24px;
      padding: 50px 40px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      position: relative;
      overflow: hidden;
      transform: scale(0.8) translateY(50px);
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow: 0 30px 80px rgba(0, 102, 204, 0.3);
      max-height: 90vh;
      overflow-y: auto;
    }

    .age-verification-overlay.show .age-verification-modal {
      transform: scale(1) translateY(0);
      opacity: 1;
      animation: modalBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes modalBounce {
      0% {
        transform: scale(0.5) translateY(100px);
        opacity: 0;
      }
      60% {
        transform: scale(1.05) translateY(-10px);
      }
      80% {
        transform: scale(0.98) translateY(5px);
      }
      100% {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    .age-verification-modal::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(0, 102, 204, 0.1), transparent 70%);
      animation: rotateGlow 8s linear infinite;
      pointer-events: none;
    }

    @keyframes rotateGlow {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    .age-verification-icon {
      font-size: 5rem;
      margin-bottom: 30px;
      animation: iconFloat 3s ease-in-out infinite;
      display: inline-block;
      filter: drop-shadow(0 10px 30px rgba(0, 102, 204, 0.5));
    }

    .age-icon-container {
      position: relative;
      display: inline-block;
      margin-bottom: 25px;
    }

    .age-logo {
      width: 100px;
      height: 100px;
      border-radius: 25px;
      box-shadow: 0 10px 30px rgba(0, 102, 204, 0.5);
      animation: iconFloat 3s ease-in-out infinite;
      object-fit: cover;
    }

    .age-badge {
      position: absolute;
      top: -10px;
      right: -15px;
      background: #ff3b30;
      color: white;
      font-weight: 800;
      padding: 5px 12px;
      border-radius: 12px;
      font-size: 1rem;
      transform: rotate(15deg);
      box-shadow: 0 5px 15px rgba(255, 59, 48, 0.4);
      z-index: 2;
      animation: pulse 2s infinite;
      border: 2px solid white;
    }

    @keyframes iconFloat {
      0%, 100% {
        transform: translateY(0) scale(1);
      }
      50% {
        transform: translateY(-15px) scale(1.1);
      }
    }

    .age-verification-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 20px;
      background: var(--gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: titleShimmer 3s ease-in-out infinite;
    }

    @keyframes titleShimmer {
      0%, 100% {
        filter: brightness(1);
      }
      50% {
        filter: brightness(1.3);
      }
    }

    .age-verification-text {
      color: var(--gray);
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 35px;
      animation: fadeInUp 0.8s ease-out 0.2s both;
    }

    .age-verification-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      animation: fadeInUp 0.8s ease-out 0.4s both;
    }

    .age-btn {
      padding: 16px 40px;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      min-width: 150px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .age-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .age-btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .age-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .age-btn:active {
      transform: translateY(-1px);
    }

    .age-btn-confirm {
      background: var(--gradient);
      color: white;
      border: 2px solid transparent;
      animation: buttonPulse 2s ease-in-out infinite;
    }

    @keyframes buttonPulse {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 102, 204, 0.4);
      }
      50% {
        box-shadow: 0 0 40px rgba(0, 102, 204, 0.8);
      }
    }

    .age-btn-confirm:hover {
      box-shadow: 0 15px 40px rgba(0, 102, 204, 0.6);
      transform: translateY(-3px) scale(1.05);
    }

    .age-btn-deny {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      color: var(--light);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-top: 1px solid rgba(255, 255, 255, 0.5);
      border-left: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2), inset 0 0 10px rgba(255,255,255,0.05);
    }

    .age-btn-deny:hover {
      background: rgba(244, 67, 54, 0.2);
      border-color: var(--danger);
      color: var(--danger);
    }

    .age-verification-warning {
      margin-top: 25px;
      padding: 15px;
      background: rgba(255, 152, 0, 0.1);
      border: 1px solid rgba(255, 152, 0, 0.3);
      border-radius: 12px;
      color: #ff9800;
      font-size: 0.9rem;
      animation: fadeInUp 0.8s ease-out 0.6s both;
    }

    .age-verification-warning-icon {
      display: inline-block;
      margin-right: 8px;
      animation: warningBounce 2s ease-in-out infinite;
    }

    @keyframes warningBounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-5px);
      }
    }

    /* ===== POPUP NOTIFICATIONS ===== */
    .notification-popup {
      position: fixed;
      top: 80px;
      right: 20px;
      padding: 15px 20px;
      background: rgba(10, 25, 47, 0.98);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: white;
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 12px;
      max-width: 380px;
      min-width: 300px;
      backdrop-filter: blur(20px);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      animation: notificationSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: auto;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      will-change: transform, opacity;
      transform: translateZ(0);
      -webkit-font-smoothing: antialiased;
    }

    .notification-popup:hover {
      transform: translateX(-5px);
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
    }

    .notification-popup.fly-to-bell {
      animation: flyToBell 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      pointer-events: none;
    }

    @keyframes notificationSlideIn {
      from {
        transform: translateX(120%);
        opacity: 0;
      }
      60% {
        transform: translateX(-10px);
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes flyToBell {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }
      50% {
        transform: translate(var(--bell-x), var(--bell-y)) scale(0.5);
        opacity: 0.8;
      }
      100% {
        transform: translate(var(--bell-x), var(--bell-y)) scale(0);
        opacity: 0;
      }
    }

    .notification-popup-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
      animation: iconPulse 2s ease-in-out infinite;
    }

    @keyframes iconPulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.1);
      }
    }

    .notification-popup-content {
      flex: 1;
      min-width: 0;
    }

    .notification-popup-message {
      font-size: 0.95rem;
      line-height: 1.4;
      word-wrap: break-word;
    }

    .notification-popup.success {
      border-color: var(--success);
      background: rgba(0, 200, 83, 0.15);
    }

    .notification-popup.warning {
      border-color: var(--warning);
      background: rgba(255, 152, 0, 0.15);
    }

    .notification-popup.error {
      border-color: var(--danger);
      background: rgba(244, 67, 54, 0.15);
    }

    .notification-popup.info {
      border-color: var(--primary);
      background: rgba(0, 102, 204, 0.15);
    }

    .coin-animation {
      position: fixed;
      font-size: 1.5rem;
      pointer-events: none;
      z-index: 9999;
      animation: coinFly 1s ease-out forwards;
    }

    @keyframes coinFly {
      0% {
        opacity: 0;
        transform: translate(0, 0) scale(0.5);
        filter: drop-shadow(0 0 0px rgba(255, 193, 7, 0));
      }
      20% {
        opacity: 1;
        filter: drop-shadow(0 0 10px rgba(255, 193, 7, 0.6));
      }
      50% {
        transform: translate(calc(var(--dx) * 0.5), calc(var(--dy) * 0.5)) scale(1.2);
        filter: drop-shadow(0 0 20px rgba(255, 193, 7, 0.8));
      }
      100% {
        opacity: 0;
        transform: translate(var(--dx), var(--dy)) scale(0.8);
        filter: drop-shadow(0 0 5px rgba(255, 193, 7, 0.3));
      }
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 768px) {
      .nav-container {
        height: 60px;
        padding: 0 15px;
      }

      .brand-logo {
        width: 35px;
        height: 35px;
      }

      .brand-text {
        font-size: 1.3rem;
      }

      .stat-pill {
        padding: 6px 12px;
        font-size: 0.9rem;
      }

      .notification-bell {
        width: 40px;
        height: 40px;
      }

      .notification-dropdown {
        width: 320px;
        right: -10px;
      }

      .hero-title {
        font-size: 2.2rem;
      }

      .hero-subtitle {
        font-size: 1.1rem;
        padding: 0 15px;
      }

      .chat-buttons {
        grid-template-columns: 1fr;
      }

      .chat-card {
        padding: 25px;
      }

      .features-grid {
        grid-template-columns: 1fr;
      }

      .steps-container {
        grid-template-columns: 1fr;
      }

      .safety-card {
        flex-direction: column;
        text-align: center;
        padding: 25px;
      }

      .footer-links {
        gap: 20px;
      }
    }

    @media (max-width: 480px) {
      .hero-title {
        font-size: 1.8rem;
      }

      .hero-subtitle {
        font-size: 1rem;
      }

      .section-title {
        font-size: 1.5rem;
      }

      .chat-card {
        padding: 20px;
      }

      .feature-card {
        padding: 25px;
      }

      .step {
        padding: 25px;
      }

      .notification-popup {
        right: 10px;
        left: 10px;
        max-width: calc(100% - 20px);
        min-width: auto;
        top: 70px;
      }

      .notification-bell {
        width: 35px;
        height: 35px;
      }

      .bell-icon {
        font-size: 1.1rem;
      }

      .notification-dropdown {
        width: calc(100vw - 40px);
        right: -20px;
        max-height: 400px;
      }

      .notification-header {
        padding: 15px;
      }

      .notification-header h3 {
        font-size: 1rem;
      }

      .notification-item {
        padding: 12px;
      }

      .notification-message {
        font-size: 0.9rem;
      }

      .age-verification-modal {
        padding: 35px 25px;
        max-width: 90%;
      }

      .age-verification-icon {
        font-size: 4rem;
        margin-bottom: 20px;
      }

      .age-verification-title {
        font-size: 1.6rem;
      }

      .age-verification-text {
        font-size: 1rem;
        margin-bottom: 25px;
      }

      .age-verification-buttons {
        flex-direction: column;
      }

      .age-btn {
        width: 100%;
        padding: 14px 30px;
        font-size: 1rem;
      }

      .age-verification-warning {
        font-size: 0.85rem;
        padding: 12px;
      }
    }

    /* Tablet landscape */
    @media (max-width: 1024px) and (orientation: landscape) {
      main {
        padding: 25px 15px;
      }

      .hero-section {
        margin-bottom: 30px;
      }

      .hero-title {
        font-size: 2.2rem;
      }

      .features-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Extra small devices */
    @media (max-width: 360px) {
      .nav-container {
        padding: 0 8px;
        height: 55px;
      }

      .brand-text {
        font-size: 1rem;
      }

      .stat-pill {
        padding: 4px 8px;
        font-size: 0.75rem;
      }

      .hero-title {
        font-size: 1.5rem;
      }

      .section-title {
        font-size: 1.3rem;
      }

      .notification-popup {
        padding: 10px 12px;
        font-size: 0.8rem;
        top: 60px;
      }

      .chat-card,
      .feature-card,
      .step {
        padding: 15px 12px;
      }

      .age-verification-modal {
        padding: 25px 15px;
      }

      .age-verification-title {
        font-size: 1.2rem;
      }
    }

    /* Touch device optimizations */
    @media (hover: none) and (pointer: coarse) {
      .chat-card,
      .feature-card,
      .step,
      .interest-tag,
      .suggestion,
      .age-btn,
      .stat-pill.coins,
      .notification-bell,
      .clear-all-btn {
        -webkit-tap-highlight-color: rgba(0, 102, 204, 0.2);
      }

      /* Increase touch targets for better usability */
      .stat-pill,
      .notification-bell {
        min-height: 44px;
        min-width: 44px;
      }

      .interest-tag .remove,
      .suggestion {
        min-height: 36px;
        min-width: 36px;
      }

      .age-btn {
        min-height: 48px;
      }

      .chat-card,
      .feature-card {
        cursor: pointer;
      }
    }

    /* Smooth scrolling and performance */
    @media (prefers-reduced-motion: no-preference) {
      html {
        scroll-behavior: smooth;
      }
    }

    /* High DPI displays */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .brand-logo,
      .notification-popup-icon,
      .chat-icon,
      .feature-icon {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
    }

    /* Prevent text size adjustment on iOS */
    @media screen and (-webkit-min-device-pixel-ratio: 0) {
      input,
      textarea,
      select {
        font-size: 16px !important;
      }
    }

    /* Landscape mobile optimizations */
    @media (max-width: 768px) and (orientation: landscape) {
      .hero-section {
        margin-bottom: 25px;
      }

      .hero-title {
        font-size: 1.8rem;
      }

      .hero-subtitle {
        font-size: 0.95rem;
      }

      .notification-popup {
        top: 60px;
      }

      .age-verification-modal {
        max-height: 90vh;
        overflow-y: auto;
      }
    }

    /* Improve notification positioning on mobile */
    @media (max-width: 768px) {
      .notification-popup {
        right: 15px;
        max-width: calc(100% - 30px);
        min-width: 280px;
      }
    }

    @media (max-width: 480px) {
      .notification-popup {
        right: 10px;
        left: 10px;
        max-width: calc(100% - 20px);
        min-width: auto;
      }

      .nav-stats {
        gap: 6px;
      }

      main {
        padding: 20px 10px;
      }

      .section-title {
        margin-bottom: 8px;
      }

      .section-subtitle {
        margin-bottom: 20px;
      }

      .interests-suggestions {
        gap: 8px;
      }

      .footer-links {
        flex-wrap: wrap;
        justify-content: center;
      }
    }
    /* Preloader */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--dark);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: opacity 0.5s ease-out, visibility 0.5s;
    }
    
    #preloader.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .preloader-content {
      text-align: center;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s ease-in-out infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Scroll to Top */
    .scroll-top-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 50px;
      height: 50px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
      transition: all 0.3s ease;
      z-index: 999;
      box-shadow: 0 5px 15px rgba(0, 102, 204, 0.4);
      border: none;
    }
    
    .scroll-top-btn.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .scroll-top-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-5px);
    }
    /* Mobile catalog menu */
    .mobile-menu-btn {
      display: none;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      color: var(--light);
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .mobile-menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      z-index: 2000;
      display: none;
    }
    .mobile-menu-overlay.show { display: block; }
    .mobile-menu-panel {
      position: absolute;
      top: 0;
      right: 0;
      width: 80%;
      max-width: 340px;
      height: 100%;
      background: rgba(10,25,47,0.95);
      border-left: 1px solid var(--border);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      animation: slideIn 0.25s ease-out;
    }
    @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    .mobile-menu-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .mobile-menu-close {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--border);
      color: var(--light);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    .mobile-menu-section {
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    @media (max-width: 768px) {
      .nav-stats { display: flex; gap: 10px; }
      .nav-stats .stat-pill.coins, .nav-stats .theme-toggle { display: none; }
      .mobile-menu-btn { display: flex; margin-left: 10px; }
    }

    /* Shimmer Effect */
    .shimmer-text {
      background: linear-gradient(90deg, #fff, #888, #fff);
      background-size: 200% auto;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: shimmer 3s linear infinite;
    }
    
    @keyframes shimmer {
      to { background-position: 200% center; }
    }

    .preloader-logo {
      width: 100px;
      height: 100px;
      border-radius: 20px;
      margin-bottom: 20px;
      box-shadow: 0 0 30px rgba(0, 102, 204, 0.5);
      animation: pulse 2s infinite;
      object-fit: cover;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 0 30px rgba(0, 102, 204, 0.5); }
      50% { transform: scale(1.05); box-shadow: 0 0 50px rgba(0, 102, 204, 0.8); }
      100% { transform: scale(1); box-shadow: 0 0 30px rgba(0, 102, 204, 0.5); }
    }
    /* ============================ */
    /* LIGHT MODE LIQUID OVERRIDES  */
    /* ============================ */
    [data-theme="light"] .chat-card {
      /* High-Key Glass */
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(240, 248, 255, 0.8));
      border: 1px solid rgba(0, 102, 204, 0.15);
      border-top: 1px solid rgba(255, 255, 255, 1);
      border-left: 1px solid rgba(255, 255, 255, 1);
      box-shadow: 
        0 10px 30px -5px rgba(0, 50, 100, 0.08),
        inset 0 0 20px rgba(255, 255, 255, 0.8);
      
      /* Darker liquid slide for visibility on light bg */
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(0, 102, 204, 0.03) 30%,
        rgba(0, 102, 204, 0.08) 45%,
        rgba(0, 102, 204, 0.12) 50%,
        rgba(0, 102, 204, 0.08) 55%,
        rgba(0, 102, 204, 0.03) 70%,
        rgba(255, 255, 255, 0) 100%
      );
    }
    
    [data-theme="light"] .chat-card:hover {
      border-color: var(--primary);
      box-shadow: 
        0 20px 40px -10px rgba(0, 102, 204, 0.2),
        inset 0 0 20px rgba(255, 255, 255, 1);
    }

    /* Interest Options (Suggestions) */
    [data-theme="light"] .suggestion {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(0, 0, 0, 0.08);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
      color: var(--gray);
      
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(0, 0, 0, 0.02) 30%,
        rgba(0, 0, 0, 0.05) 50%,
        rgba(0, 0, 0, 0.02) 70%,
        rgba(255, 255, 255, 0) 100%
      );
    }

    [data-theme="light"] .suggestion:hover {
      background-color: white;
      border-color: var(--primary);
      color: var(--primary);
      box-shadow: 0 5px 15px rgba(0, 102, 204, 0.15);
    }

    /* Selected Interests */
    [data-theme="light"] .interest-tag {
      background: rgba(0, 102, 204, 0.08);
      border: 1px solid rgba(0, 102, 204, 0.2);
      color: var(--primary);
      box-shadow: 0 4px 10px rgba(0, 102, 204, 0.1);
      
      background-image: linear-gradient(
        105deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(0, 102, 204, 0.05) 50%,
        rgba(255, 255, 255, 0) 100%
      );
    }
    
    /* Other Buttons */
    [data-theme="light"] .stat-pill,
    [data-theme="light"] .notification-bell,
    [data-theme="light"] .clear-all-btn,
    [data-theme="light"] .age-btn {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(0, 0, 0, 0.08);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      color: var(--gray-dark);
    }

    [data-theme="light"] .age-btn-confirm {
      background: var(--primary);
      color: white;
      border: none;
    }
    
    [data-theme="light"] .age-btn-deny {
       background: rgba(255, 255, 255, 0.9);
       color: var(--gray);
     }
 
     /* Header & Navigation Light Mode */
     [data-theme="light"] header {
       background: rgba(255, 255, 255, 0.95);
       border-bottom: 1px solid rgba(0, 0, 0, 0.05);
     }
     
     [data-theme="light"] .brand-logo {
       box-shadow: 0 4px 10px rgba(0, 102, 204, 0.2);
     }
     
     [data-theme="light"] .theme-toggle {
       background: rgba(0, 0, 0, 0.05);
       color: var(--primary);
       border-color: rgba(0, 0, 0, 0.1);
     }
     
     [data-theme="light"] .theme-toggle:hover {
       background: rgba(0, 0, 0, 0.1);
     }

     /* Inputs Light Mode */
     [data-theme="light"] .interests-input input {
       background: rgba(0, 0, 0, 0.03);
       color: var(--light); /* Is dark in light mode */
       border-color: rgba(0, 0, 0, 0.1);
     }
     
     [data-theme="light"] .interests-input input:focus {
       background: white;
       border-color: var(--primary);
       box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
     }
     
     /* Notifications Light Mode */
     [data-theme="light"] .notification-dropdown {
       background: rgba(255, 255, 255, 0.98);
       border-color: rgba(0, 0, 0, 0.05);
       box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
     }
     
     [data-theme="light"] .notification-header {
       background: rgba(0, 102, 204, 0.05);
       border-bottom-color: rgba(0, 0, 0, 0.05);
     }
     
     [data-theme="light"] .notification-item {
       background: rgba(0, 0, 0, 0.02);
       border-color: rgba(0, 0, 0, 0.05);
     }
     
     [data-theme="light"] .notification-item:hover {
       background: rgba(0, 102, 204, 0.05);
     }
     
     [data-theme="light"] .notification-message {
       color: var(--light);
     }
     
     [data-theme="light"] .notification-list::-webkit-scrollbar-track {
       background: rgba(0, 0, 0, 0.05);
     }
     
     /* Hero & Headings Light Mode */
     [data-theme="light"] .hero-title {
       text-shadow: none; /* Remove glow in light mode for better contrast */
     }
     
     [data-theme="light"] .section-title {
        /* Ensure gradients are visible */
        text-shadow: 0 2px 10px rgba(0,0,0,0.05);
     }

     /* Feature Cards Light Mode */
     [data-theme="light"] .feature-card {
       background: rgba(255, 255, 255, 0.8);
       box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
       border: 1px solid rgba(0, 0, 0, 0.05);
     }
     
     [data-theme="light"] .feature-card:hover {
       background: white;
       box-shadow: 0 20px 40px rgba(0, 102, 204, 0.1);
     }

    /* Video Popup Styles */
    .video-popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 100000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .video-popup-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .video-popup-modal {
      width: 90%;
      max-width: 900px;
      background: black;
      border-radius: 20px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 102, 204, 0.5);
      transform: scale(0.9);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .video-popup-overlay.show .video-popup-modal {
      transform: scale(1);
    }

    .video-popup-close {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      font-size: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }

    .video-popup-close:hover {
      background: var(--danger);
      border-color: var(--danger);
      transform: rotate(90deg);
    }

    .video-container {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
      background: black;
    }

    .video-container video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    /* Mobile Responsiveness for Video Popup */
    @media (max-width: 768px) {
      .video-popup-modal {
        width: 95%;
        border-radius: 12px;
      }

      .video-popup-close {
        top: 10px;
        right: 10px;
        width: 35px;
        height: 35px;
        font-size: 20px;
        background: rgba(0, 0, 0, 0.8);
      }
    }


  </style>
</head>
<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="preloader-content">
      <img src="logo.jpeg" class="preloader-logo" alt="Mana Mingle">
      <div class="spinner"></div>
      <h2 class="brand-text">Mana Mingle</h2>
    </div>
  </div>
  <!-- Age Verification Modal -->
  <div class="age-verification-overlay" id="ageVerificationOverlay">
    <div class="age-verification-modal">
      <div class="age-verification-icon"></div>
      <h2 class="age-verification-title">Age Verification Required</h2>
      <p class="age-verification-text">
        You must be <strong>18 years or older</strong> to access this website. 
        This platform is designed for adults only and contains content intended 
        for mature audiences.
      </p>
      <div class="age-verification-buttons">
        <button class="age-btn age-btn-confirm" id="ageConfirmBtn">
          I am 18 or older
        </button>
        <button class="age-btn age-btn-deny" id="ageDenyBtn">
          I am under 18
        </button>
      </div>
      <div class="age-verification-warning">
        <span class="age-verification-warning-icon"></span>
        By clicking "I am 18 or older", you confirm that you meet the age requirement 
        and agree to our Terms of Service.
      </div>
    </div>
  </div>

  <!-- Video Popup Modal -->
  <div class="video-popup-overlay" id="videoPopupOverlay">
    <div class="video-popup-modal">
      <button class="video-popup-close" id="videoPopupClose">&times;</button>
      <div class="video-container">
        <video id="introVideo" controls playsinline preload="none">
          <source src="intro.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
    </div>
  </div>

  <!-- Animated Background -->
  <div class="background-animation">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
    <div class="gradient-orb orb-3"></div>
    <div class="particles" id="particles"></div>
  </div>

  <!-- Navbar -->
  <header>
    <div class="nav-container">
      <a class="brand" href="#">
        <img src="logo.jpeg" class="brand-logo-img" alt="Mana Mingle">
        <div class="brand-text">Mana Mingle</div>
      </a>
      
      <div class="nav-stats">
        <div class="stat-pill online">
          <span class="indicator"></span>
          <span id="onlineCount">0 Online</span>
        </div>
        
        <div class="stat-pill coins">
          <span></span>
          <span id="manaCoins">0</span>
        </div>

        <button class="theme-toggle" id="themeToggle" aria-label="Toggle Theme">
          <span></span>
        </button>
        
        <div class="notification-bell" id="notificationBell">
          <div class="bell-icon"></div>
          <div class="notification-badge hidden" id="notificationBadge">0</div>
          
          <div class="notification-dropdown" id="notificationDropdown">
            <div class="notification-header">
              <h3>Notifications</h3>
              <button class="clear-all-btn" id="clearAllBtn">Clear All</button>
            </div>
            <div class="notification-list" id="notificationList">
              <div class="notification-empty">
                <div class="notification-empty-icon"></div>
                <div class="notification-empty-text">No notifications yet</div>
              </div>
            </div>
          </div>
        </div>
      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Menu"></button>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-badge"> Safe & Anonymous</div>
      <h1 class="hero-title">Connect with Strangers Worldwide</h1>
      <p class="hero-subtitle">
        Experience professional-grade anonymous chatting with smart matching, 
        real-time monitoring, and seamless connections across text, video, and group chats.
      </p>
    </section>

    <!-- Chat Options -->
    <section class="chat-section">
      <div class="section-title">Start Your Journey</div>
      <p class="section-subtitle">Choose your preferred way to connect</p>
      
      <div class="chat-buttons">
        <div class="chat-card" id="textChat">
          <div class="chat-icon"></div>
          <h3 class="chat-title">Text Chat</h3>
          <p class="chat-desc">
            Connect instantly through text-based conversations. Perfect for 
            casual chats and meaningful conversations.
          </p>
        </div>
        
        <div class="chat-card" id="videoChat">
          <div class="chat-icon"></div>
          <h3 class="chat-title">Video Chat</h3>
          <p class="chat-desc">
            Face-to-face conversations with real-time video. Experience 
            authentic connections with video moderation.
          </p>
        </div>
        
        <div class="chat-card" id="groupChat">
          <div class="chat-icon"></div>
          <h3 class="chat-title">Group Chat</h3>
          <p class="chat-desc">
            Join or create group discussions on various topics. Meet multiple 
            people with similar interests.
          </p>
        </div>
      </div>
    </section>

    

    <!-- Interests -->
    <section class="interests-section">
      <div class="section-title">Customize Your Experience</div>
      <p class="section-subtitle">Add interests for better matching</p>
      
      <div class="interests-container">
        <div class="interests-input">
          <input 
            type="text" 
            id="interestInput" 
            placeholder="Type your interests (e.g., Music, Gaming, Movies)"
            maxlength="20"
          >
        </div>
        
        <div class="interests-display" id="interestsDisplay"></div>
        
        <div class="interests-suggestions">
          <div class="suggestion" data-interest="Music"> Music</div>
          <div class="suggestion" data-interest="Gaming"> Gaming</div>
          <div class="suggestion" data-interest="Movies"> Movies</div>
          <div class="suggestion" data-interest="Sports"> Sports</div>
          <div class="suggestion" data-interest="Tech"> Tech</div>
          <div class="suggestion" data-interest="Food"> Food</div>
        </div>
      </div>
    </section>

    <!-- Features -->
    <section class="features-section">
      <div class="section-title">Why Choose Mana Mingle?</div>
      <p class="section-subtitle">Premium features for a better experience</p>
      
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon"></div>
          <h3 class="feature-title">AI-Powered Matching</h3>
          <p class="feature-desc">
            Our intelligent algorithm matches you with people who share your 
            interests and conversation style.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon"></div>
          <h3 class="feature-title">Real-Time Monitoring</h3>
          <p class="feature-desc">
            Advanced AI monitors all conversations to ensure a safe and 
            respectful environment for everyone.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon"></div>
          <h3 class="feature-title">Lightning Fast</h3>
          <p class="feature-desc">
            Connect with strangers in under 3 seconds. No registration, 
            no delays, just instant connections.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon"></div>
          <h3 class="feature-title">Global Community</h3>
          <p class="feature-desc">
            Connect with people from different cultures and backgrounds. 
            Expand your horizons with every chat.
          </p>
        </div>
      </div>
    </section>

    <!-- Steps -->
    <section class="steps-section">
      <div class="section-title">How It Works</div>
      <p class="section-subtitle">Simple steps to meaningful connections</p>
      
      <div class="steps-container">
        <div class="step">
          <div class="step-number">1</div>
          <h3 class="step-title">Add Interests</h3>
          <p class="step-desc">
            Optionally add interests to help our AI match you with 
            like-minded people.
          </p>
        </div>
        
        <div class="step">
          <div class="step-number">2</div>
          <h3 class="step-title">Choose Mode</h3>
          <p class="step-desc">
            Select from text, video, or group chat based on your 
            current mood and preference.
          </p>
        </div>
        
        <div class="step">
          <div class="step-number">3</div>
          <h3 class="step-title">Connect & Chat</h3>
          <p class="step-desc">
            Start chatting instantly. You can skip, report, or continue 
            the conversation anytime.
          </p>
        </div>
      </div>
    </section>

    <!-- Safety Notice -->
    <section class="safety-section">
      <div class="section-title">Safety First</div>
      <p class="section-subtitle">Your safety is our priority</p>
      
      <div class="safety-card">
        <div class="safety-icon"></div>
        <div class="safety-content">
          <h3>Community Guidelines</h3>
          <p>
            We maintain a strict policy against harassment, hate speech, 
            and inappropriate content. All conversations are monitored to 
            ensure a safe environment for everyone aged 18+.
          </p>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="privacy-policy.html" id="privacyLink">Privacy Policy</a>
        <a href="terms-of-service.html" id="termsLink">Terms of Service</a>
        <a href="contact.html" id="contactLink">Contact</a>
        <a href="report.html" id="reportLink">Report Abuse</a>
      </div>
      <p class="copyright"> 2026 Mana Mingle. For users 18+ only.</p>
      <p class="copyright" style="margin-top: 10px;">
        Built with  for meaningful connections worldwide
      </p>
    </div>
  </footer>

  <button class="scroll-top-btn" id="scrollTopBtn" aria-label="Scroll to top"></button>
  <div class="mobile-menu-overlay" id="mobileMenu">
    <div class="mobile-menu-panel">
      <div class="mobile-menu-header">
        <div class="brand-text">Menu</div>
        <button class="mobile-menu-close" id="mobileMenuClose"></button>
      </div>
      <div class="mobile-menu-section">
        <div style="display:flex; align-items:center; gap:8px;">
          <span></span>
          <span id="manaCoinsMobile">0</span>
        </div>
        <button class="stat-pill coins" style="padding:6px 10px;">Add</button>
      </div>
      <div class="mobile-menu-section">
        <div style="font-weight:600;">Theme</div>
        <button class="theme-toggle" id="themeToggleMobile" aria-label="Toggle Theme">
          <span></span>
        </button>
      </div>
    </div>
  </div>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script>
    (function(){
      var prod = /manamingle\.site$/i.test(location.hostname);
      if (prod) {
        var a = document.createElement('script');
        a.src = '/js/ad-manager.js';
        document.body.appendChild(a);
      }
    })();
  </script>
  <script>
    // ============================
    // GLOBAL STATE
    // ============================
    const appState = {
      interests: [],
      manaCoins: 0,
      onlineCount: 0,
      notifications: [],
      notificationDropdownOpen: false
    };

    // ============================
    // AGE VERIFICATION
    // ============================
    function checkAgeVerification() {
      const today = new Date().toDateString();
      const lastVerification = localStorage.getItem('ageVerificationDate');
      
      // Check if verified today
      if (lastVerification === today) {
        return true; // Already verified today
      }
      
      // Show age verification modal
      showAgeVerification();
      return false;
    }

    function showAgeVerification() {
      const overlay = document.getElementById('ageVerificationOverlay');
      if (overlay) {
        // Small delay for smooth animation
        setTimeout(() => {
          overlay.classList.add('show');
          // Prevent body scroll
          document.body.style.overflow = 'hidden';
          const preloader = document.getElementById('preloader');
          if (preloader) {
            preloader.classList.add('hidden');
            setTimeout(() => preloader.remove(), 500);
          }
        }, 100);
      }
    }

    function hideAgeVerification() {
      const overlay = document.getElementById('ageVerificationOverlay');
      if (overlay) {
        overlay.classList.remove('show');
        // Restore body scroll
        document.body.style.overflow = '';
      }
    }

    function confirmAge() {
      const today = new Date().toDateString();
      localStorage.setItem('ageVerificationDate', today);
      localStorage.setItem('ageVerified', 'true');
      
      // Add success animation
      const modal = document.querySelector('.age-verification-modal');
      if (modal) {
        modal.style.animation = 'modalBounce 0.4s ease-out reverse';
      }
      
      setTimeout(() => {
        hideAgeVerification();
        showNotification('Age verification successful. Welcome!', 'success');
      }, 300);
    }

    function denyAge() {
      // Show denial message
      const modal = document.querySelector('.age-verification-modal');
      if (modal) {
        modal.style.animation = 'shake 0.5s ease-in-out';
      }
      
      showNotification('You must be 18 or older to access this site.', 'error');
      
      // Redirect after delay
      setTimeout(() => {
        window.location.href = 'https://www.google.com';
      }, 2000);
    }

    // Shake animation for denial
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        20%, 40%, 60%, 80% { transform: translateX(10px); }
      }
    `;
    document.head.appendChild(style);

    // ============================
    // INITIALIZATION
    // ============================
    document.addEventListener('DOMContentLoaded', () => {
      // Check age verification first (blocks everything until verified)
      if (!checkAgeVerification()) {
        // Set up age verification buttons
        document.getElementById('ageConfirmBtn')?.addEventListener('click', confirmAge);
        document.getElementById('ageDenyBtn')?.addEventListener('click', denyAge);
        
        // Prevent ESC key from closing (must make a choice)
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            const overlay = document.getElementById('ageVerificationOverlay');
            if (overlay && overlay.classList.contains('show')) {
              e.preventDefault();
              showNotification('Please confirm your age to continue.', 'warning');
            }
          }
        });
        
        return; // Don't initialize rest of app until verified
      }
      
      initializeParticles();
      ensureSessionAndSync();
      loadFromStorage();
      setupEventListeners();
      setupVideoPopup();
      loadAdConfigForIndex().then(applyAdEnablement);
      updateUI();
      connectSocket();
      startCoinTimer();
      initializeAdvancedFeatures();
      
      // Performance optimizations for mobile
      optimizeForMobile();
      
      // Handle window resize for responsive elements
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          updatePopupPositions();
          // Recalculate notification positions
          const popups = document.querySelectorAll('.notification-popup:not(.fly-to-bell)');
          const isMobile = window.innerWidth <= 480;
          const baseTop = isMobile ? 70 : 80;
          const spacing = isMobile ? 70 : 80;
          popups.forEach((popup, index) => {
            popup.style.top = `${baseTop + (index * spacing)}px`;
          });
        }, 150);
      });
      
      // Prevent zoom on double tap (iOS)
      let lastTouchEnd = 0;
      document.addEventListener('touchend', (e) => {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
          e.preventDefault();
        }
        lastTouchEnd = now;
      }, false);
      
      console.log(' Mana Mingle Professional Edition ready');
    });

    // ============================
    // SESSION & SYNC
    // ============================
    async function ensureSessionAndSync(){
      try {
        const s = await fetch('/api/session');
        await s.json();
        const b = await fetch('/api/coins/balance');
        const bj = await b.json();
        if (typeof bj.coins === 'number') {
          appState.manaCoins = bj.coins;
          saveToStorage();
          updateCoinsDisplay();
        }
      } catch (e) {}
    }

    // ============================
    // MOBILE OPTIMIZATIONS
    // ============================
    function optimizeForMobile() {
      // Reduce particle count on mobile for better performance
      const isMobile = window.innerWidth <= 768;
      if (isMobile) {
        const particles = document.querySelectorAll('.particle');
        if (particles.length > 15) {
          particles.forEach((particle, index) => {
            if (index >= 15) {
              particle.remove();
            }
          });
        }
      }

      // Disable heavy animations on low-end devices
      if (navigator.hardwareConcurrency && navigator.hardwareConcurrency < 4) {
        document.body.classList.add('low-performance');
        const style = document.createElement('style');
        style.textContent = `
          .low-performance .gradient-orb {
            animation-duration: 30s !important;
          }
          .low-performance .particle {
            animation-duration: 20s !important;
          }
        `;
        document.head.appendChild(style);
      }

      // Optimize scroll performance
      if ('scrollBehavior' in document.documentElement.style) {
        document.documentElement.style.scrollBehavior = 'smooth';
      }
    }

    // ============================
    // PARTICLE BACKGROUND
    // ============================
    function initializeParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // Random properties
        const size = Math.random() * 5 + 2;
        const left = Math.random() * 100;
        const duration = Math.random() * 10 + 15;
        const delay = Math.random() * 5;
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${left}%`;
        particle.style.animationDelay = `${delay}s`;
        particle.style.animationDuration = `${duration}s`;
        
        particlesContainer.appendChild(particle);
      }
    }

    // ============================
    // SOCKET CONNECTION
    // ============================
    function connectSocket() {
      const socket = io("https://manamingle.site", {
        transports: ["websocket"]
      });

      socket.on("online_count", ({ count }) => {
        appState.onlineCount = count;
        updateOnlineCount();
      });

      socket.on("connect", () => {
        console.log(" Connected to server");
      });

      socket.on("disconnect", () => {
        console.log(" Disconnected from server");
      });
    }

    function updateOnlineCount() {
      const display = document.getElementById('onlineCount');
      if (display) {
        const isMobile = window.matchMedia('(max-width: 768px)').matches;
        const count = appState.onlineCount || 0;
        display.textContent = isMobile ? (count > 99 ? '99+' : String(count)) : `${count} Online`;
      }
    }

    // ============================
    // STORAGE FUNCTIONS
    // ============================
    function loadFromStorage() {
      try {
        const savedInterests = localStorage.getItem('manaInterests');
        if (savedInterests) {
          appState.interests = JSON.parse(savedInterests);
        }
        
        const savedCoins = localStorage.getItem('manaCoins');
        if (savedCoins) {
          appState.manaCoins = parseInt(savedCoins) || 0;
        }
        
        const savedNotifications = localStorage.getItem('manaNotifications');
        if (savedNotifications) {
          appState.notifications = JSON.parse(savedNotifications);
          // Keep only last 50 notifications
          if (appState.notifications.length > 50) {
            appState.notifications = appState.notifications.slice(-50);
          }
        }
      } catch (e) {
        console.error('Error loading from storage:', e);
      }
    }

    function saveToStorage() {
      try {
        localStorage.setItem('manaInterests', JSON.stringify(appState.interests));
        localStorage.setItem('manaCoins', appState.manaCoins.toString());
        localStorage.setItem('manaNotifications', JSON.stringify(appState.notifications));
      } catch (e) {
        console.error('Error saving to storage:', e);
      }
    }

    // ============================
    // UI UPDATE FUNCTIONS
    // ============================
    function updateUI() {
      renderInterests();
      updateCoinsDisplay();
      updateOnlineCount();
      renderNotifications();
      updateNotificationBadge();
    }

    function updateCoinsDisplay() {
      const display = document.getElementById('manaCoins');
      if (display) {
        display.textContent = appState.manaCoins;
      }
      const displayMobile = document.getElementById('manaCoinsMobile');
      if (displayMobile) {
        displayMobile.textContent = appState.manaCoins;
      }
    }

    window.addEventListener('storage', (e) => {
      if (e.key === 'manaCoins') {
        const v = parseInt(e.newValue || '0', 10) || 0;
        appState.manaCoins = v;
        updateCoinsDisplay();
      }
    });

    // ============================
    // INTERESTS SYSTEM
    // ============================
    function renderInterests() {
      const display = document.getElementById('interestsDisplay');
      
      if (!display) return;
      
      display.innerHTML = '';
      
      if (appState.interests.length === 0) {
        const placeholder = document.createElement('div');
        placeholder.style.color = 'var(--gray)';
        placeholder.style.fontStyle = 'italic';
        placeholder.textContent = 'No interests added yet';
        display.appendChild(placeholder);
        return;
      }
      
      appState.interests.forEach((interest, index) => {
        const tag = document.createElement('div');
        tag.className = 'interest-tag';
        tag.innerHTML = `
          <span>${interest}</span>
          <span class="remove" data-index="${index}"></span>
        `;
        display.appendChild(tag);
      });
      
      // Add event listeners to remove buttons
      document.querySelectorAll('.interest-tag .remove').forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          removeInterest(index);
        });
      });
    }

    function addInterest(interest) {
      if (!interest || interest.trim() === '') return false;
      
      const cleanInterest = interest.trim();
      
      if (appState.interests.length >= 5) {
        showNotification('Maximum 5 interests allowed', 'warning');
        return false;
      }
      
      if (appState.interests.includes(cleanInterest)) {
        showNotification(`"${cleanInterest}" already added`, 'info');
        return false;
      }
      
      appState.interests.push(cleanInterest);
      saveToStorage();
      renderInterests();
      showNotification(`Added interest: ${cleanInterest}`, 'success');
      return true;
    }

    function removeInterest(index) {
      if (index >= 0 && index < appState.interests.length) {
        const removedInterest = appState.interests[index];
        appState.interests.splice(index, 1);
        saveToStorage();
        renderInterests();
        showNotification(`Removed interest: ${removedInterest}`, 'info');
      }
    }

    // ============================
    // NOTIFICATION SYSTEM
    // ============================
    function showNotification(message, type = 'info') {
      // Create notification object
      const notification = {
        id: Date.now() + Math.random(),
        message: message,
        type: type,
        timestamp: new Date(),
        read: false
      };
      
      // Add to notifications array (prepend for newest first)
      appState.notifications.unshift(notification);
      
      // Keep only last 50 notifications
      if (appState.notifications.length > 50) {
        appState.notifications = appState.notifications.slice(0, 50);
      }
      
      // Save to storage
      saveToStorage();
      
      // Update UI
      renderNotifications();
      updateNotificationBadge();
      
      // Animate bell
      animateBell();
      
      // Create popup notification
      createPopupNotification(message, type);
      
      // Auto-mark as read after 5 seconds if dropdown is closed
      if (!appState.notificationDropdownOpen) {
        setTimeout(() => {
          const notif = appState.notifications.find(n => n.id === notification.id);
          if (notif && !notif.read) {
            notif.read = true;
            saveToStorage();
            renderNotifications();
            updateNotificationBadge();
          }
        }, 5000);
      }
    }

    function createPopupNotification(message, type = 'info') {
      // Remove existing popups
      const existingPopups = document.querySelectorAll('.notification-popup');
      existingPopups.forEach((popup, index) => {
        // Move existing popups down
        const currentTop = parseInt(popup.style.top) || 80;
        popup.style.top = `${currentTop + 80}px`;
      });

      // Create popup element
      const popup = document.createElement('div');
      popup.className = `notification-popup ${type}`;
      
      // Set icon based on type
      let icon = '';
      if (type === 'warning') icon = '';
      if (type === 'success') icon = '';
      if (type === 'error') icon = '';
      
      popup.innerHTML = `
        <div class="notification-popup-icon">${icon}</div>
        <div class="notification-popup-content">
          <div class="notification-popup-message">${message}</div>
        </div>
      `;
      
      // Calculate position (stack notifications)
      const existingCount = document.querySelectorAll('.notification-popup:not(.fly-to-bell)').length;
      const isMobile = window.innerWidth <= 480;
      const baseTop = isMobile ? 70 : 80;
      const spacing = isMobile ? 70 : 80;
      const topPosition = baseTop + (existingCount * spacing);
      popup.style.top = `${topPosition}px`;
      
      document.body.appendChild(popup);
      
      // Click to dismiss (fly to bell immediately)
      popup.addEventListener('click', () => {
        flyNotificationToBell(popup);
      });
      
      // Auto-dismiss after 4 seconds
      setTimeout(() => {
        if (popup.parentNode) {
          flyNotificationToBell(popup);
        }
      }, 4000);
    }

    function flyNotificationToBell(popup) {
      const bell = document.getElementById('notificationBell');
      if (!bell) {
        // If bell not found, just fade out
        popup.style.opacity = '0';
        popup.style.transform = 'translateX(100%)';
        setTimeout(() => popup.remove(), 300);
        return;
      }
      
      // Get positions
      const popupRect = popup.getBoundingClientRect();
      const bellRect = bell.getBoundingClientRect();
      
      // Calculate distance to bell
      const deltaX = bellRect.left + bellRect.width / 2 - (popupRect.left + popupRect.width / 2);
      const deltaY = bellRect.top + bellRect.height / 2 - (popupRect.top + popupRect.height / 2);
      
      // Set CSS variables for animation
      popup.style.setProperty('--bell-x', `${deltaX}px`);
      popup.style.setProperty('--bell-y', `${deltaY}px`);
      
      // Add fly animation class
      popup.classList.add('fly-to-bell');
      
      // Remove after animation
      setTimeout(() => {
        if (popup.parentNode) {
          popup.remove();
        }
        // Animate bell when notification arrives
        animateBell();
      }, 800);
      
      // Update other popups positions
      updatePopupPositions();
    }

    function updatePopupPositions() {
      const popups = document.querySelectorAll('.notification-popup:not(.fly-to-bell)');
      const isMobile = window.innerWidth <= 480;
      const baseTop = isMobile ? 70 : 80;
      const spacing = isMobile ? 70 : 80;
      popups.forEach((popup, index) => {
        popup.style.top = `${baseTop + (index * spacing)}px`;
      });
    }

    function animateBell() {
      const bell = document.getElementById('notificationBell');
      if (bell) {
        bell.classList.add('active');
        const bellIcon = bell.querySelector('.bell-icon');
        bellIcon.style.animation = 'bellBounce 0.6s ease-in-out';
        setTimeout(() => {
          bell.classList.remove('active');
          bellIcon.style.animation = '';
        }, 600);
      }
    }

    function renderNotifications() {
      const list = document.getElementById('notificationList');
      if (!list) return;
      
      if (appState.notifications.length === 0) {
        list.innerHTML = `
          <div class="notification-empty">
            <div class="notification-empty-icon"></div>
            <div class="notification-empty-text">No notifications yet</div>
          </div>
        `;
        return;
      }
      
      list.innerHTML = '';
      
      appState.notifications.forEach((notif, index) => {
        const item = document.createElement('div');
        item.className = `notification-item ${notif.read ? 'read' : ''}`;
        item.style.animationDelay = `${index * 0.05}s`;
        
        // Set icon based on type
        let icon = '';
        if (notif.type === 'warning') icon = '';
        if (notif.type === 'success') icon = '';
        if (notif.type === 'error') icon = '';
        
        // Format time
        const timeAgo = getTimeAgo(notif.timestamp);
        
        item.innerHTML = `
          <div class="notification-content">
            <div class="notification-icon">${icon}</div>
            <div class="notification-text">
              <div class="notification-message">${notif.message}</div>
              <div class="notification-time">${timeAgo}</div>
            </div>
          </div>
        `;
        
        // Click to mark as read
        item.addEventListener('click', () => {
          if (!notif.read) {
            notif.read = true;
            saveToStorage();
            renderNotifications();
            updateNotificationBadge();
          }
        });
        
        list.appendChild(item);
      });
    }

    function getTimeAgo(timestamp) {
      const now = new Date();
      const time = new Date(timestamp);
      const diffMs = now - time;
      const diffSecs = Math.floor(diffMs / 1000);
      const diffMins = Math.floor(diffSecs / 60);
      const diffHours = Math.floor(diffMins / 60);
      const diffDays = Math.floor(diffHours / 24);
      
      if (diffSecs < 60) return 'Just now';
      if (diffMins < 60) return `${diffMins}m ago`;
      if (diffHours < 24) return `${diffHours}h ago`;
      if (diffDays < 7) return `${diffDays}d ago`;
      
      return time.toLocaleDateString();
    }

    function updateNotificationBadge() {
      const badge = document.getElementById('notificationBadge');
      if (!badge) return;
      
      const unreadCount = appState.notifications.filter(n => !n.read).length;
      
      if (unreadCount > 0) {
        badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
        badge.classList.remove('hidden');
      } else {
        badge.classList.add('hidden');
      }
    }

    function toggleNotificationDropdown() {
      appState.notificationDropdownOpen = !appState.notificationDropdownOpen;
      const dropdown = document.getElementById('notificationDropdown');
      const bell = document.getElementById('notificationBell');
      
      if (dropdown && bell) {
        if (appState.notificationDropdownOpen) {
          dropdown.classList.add('show');
          bell.classList.add('active');
        } else {
          dropdown.classList.remove('show');
          bell.classList.remove('active');
        }
      }
    }

    function clearAllNotifications() {
      appState.notifications = [];
      saveToStorage();
      renderNotifications();
      updateNotificationBadge();
    }

    // ============================
    // COIN SYSTEM
    // ============================
    function showCoinAnimation(amount) {
      const coinsDisplay = document.querySelector('.stat-pill.coins');
      if (!coinsDisplay) return;
      
      const rect = coinsDisplay.getBoundingClientRect();
      const coinCount = Math.min(amount, 5);
      
      for (let i = 0; i < coinCount; i++) {
        setTimeout(() => {
          const coin = document.createElement('div');
          coin.className = 'coin-animation';
          coin.textContent = '';
          
          const dx = (Math.random() - 0.5) * 200;
          const dy = (Math.random() - 1) * 200;
          
          coin.style.left = rect.left + rect.width / 2 + 'px';
          coin.style.top = rect.top + rect.height / 2 + 'px';
          coin.style.setProperty('--dx', `${dx}px`);
          coin.style.setProperty('--dy', `${dy}px`);
          
          document.body.appendChild(coin);
          
          setTimeout(() => coin.remove(), 1000);
        }, i * 100);
      }
    }

    function creditCoins(amount, source = 'auto') {
      appState.manaCoins += amount;
      saveToStorage();
      updateCoinsDisplay();
      showCoinAnimation(amount);
      try { fetch('/api/coins/credit', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ amount }) }); } catch (_) {}
      
      if (source === 'click') {
        showNotification(` +${amount} coins!`, 'success');
      } else {
        showNotification(` +${amount} coins (Auto-credit every 4 hours)`, 'success');
      }
    }

    function canCreditCoins() {
      const COIN_CREDIT_INTERVAL = 4 * 60 * 60 * 1000; // 4 hours
      const lastCreditTime = localStorage.getItem('lastCoinCreditTime');
      const now = Date.now();
      
      if (!lastCreditTime) {
        return true; // First time, can credit
      }
      
      const timeSinceLastCredit = now - parseInt(lastCreditTime);
      return timeSinceLastCredit >= COIN_CREDIT_INTERVAL;
    }

    function getTimeUntilNextCredit() {
      const COIN_CREDIT_INTERVAL = 4 * 60 * 60 * 1000; // 4 hours
      const lastCreditTime = localStorage.getItem('lastCoinCreditTime');
      const now = Date.now();
      
      if (!lastCreditTime) {
        return 0;
      }
      
      const timeSinceLastCredit = now - parseInt(lastCreditTime);
      const timeRemaining = COIN_CREDIT_INTERVAL - timeSinceLastCredit;
      
      return Math.max(0, timeRemaining);
    }

    function formatTimeRemaining(ms) {
      const hours = Math.floor(ms / (60 * 60 * 1000));
      const minutes = Math.floor((ms % (60 * 60 * 1000)) / (60 * 1000));
      
      if (hours > 0) {
        return `${hours}h ${minutes}m`;
      }
      return `${minutes}m`;
    }

    function handleCoinClick() {
      if (canCreditCoins()) {
        const COIN_CREDIT_AMOUNT = 30;
        creditCoins(COIN_CREDIT_AMOUNT, 'click');
        localStorage.setItem('lastCoinCreditTime', Date.now().toString());
        
        // Add click animation to coin emoji
        const coinEmoji = document.querySelector('.stat-pill.coins span:first-child');
        if (coinEmoji) {
          coinEmoji.style.animation = 'coinClick 0.5s ease-out';
          setTimeout(() => {
            coinEmoji.style.animation = '';
          }, 500);
        }
      } else {
        const timeRemaining = getTimeUntilNextCredit();
        const formattedTime = formatTimeRemaining(timeRemaining);
        showNotification(` Coins available in ${formattedTime}`, 'warning');
        
        // Shake animation for denied click
        const coinPill = document.querySelector('.stat-pill.coins');
        if (coinPill) {
          coinPill.style.animation = 'shakeDenied 0.5s ease-in-out';
          setTimeout(() => {
            coinPill.style.animation = '';
          }, 500);
        }
      }
    }

    // 4-hour timer for auto-crediting coins
    function checkAutoCoinCredit() {
      const COIN_CREDIT_INTERVAL = 4 * 60 * 60 * 1000; // 4 hours in milliseconds
      const COIN_CREDIT_AMOUNT = 30;
      
      const lastCreditTime = localStorage.getItem('lastCoinCreditTime');
      const now = Date.now();
      
      if (!lastCreditTime) {
        // First time - set initial time and don't credit yet
        localStorage.setItem('lastCoinCreditTime', now.toString());
        return;
      }
      
      const timeSinceLastCredit = now - parseInt(lastCreditTime);
      
      if (timeSinceLastCredit >= COIN_CREDIT_INTERVAL) {
        // 4 hours have passed - credit coins automatically
        creditCoins(COIN_CREDIT_AMOUNT, 'auto');
        localStorage.setItem('lastCoinCreditTime', now.toString());
      }
    }

    function startCoinTimer() {
      // Check immediately on load
      checkAutoCoinCredit();
      
      // Set up interval to check every hour (to catch when 4 hours pass)
      setInterval(() => {
        checkAutoCoinCredit();
      }, 60 * 60 * 1000); // Check every hour
    }

    // ============================
    // CHAT FUNCTIONS
    // ============================
    function startChat(mode) {
      const card = document.getElementById(`${mode}Chat`);
      if (!card) return;
      
      // Add click animation
      const originalTransform = card.style.transform;
      card.style.transform = 'scale(0.95)';
      setTimeout(() => {
        card.style.transform = originalTransform;
      }, 200);
      
      // Remove any existing loader
      const existingLoader = card.querySelector('.loading-overlay');
      if (existingLoader) existingLoader.remove();

      // Create loader
      const loader = document.createElement('div');
      loader.className = 'loading-overlay';
      loader.innerHTML = '<div class="spinner"></div>';
      card.appendChild(loader);
      try { window.ManaAds && window.ManaAds.triggerClickAd(); } catch (_) {}
      
      // Redirect after delay
      setTimeout(() => {
        const params = new URLSearchParams();
        if (appState.interests && appState.interests.length > 0) {
           params.append('tags', JSON.stringify(appState.interests));
        }

        if (mode === 'group') {
          window.location.href = 'groupchat.html';
        } else if (mode === 'video') {
          params.append('mode', 'video');
          window.location.href = `videochat.html?${params.toString()}`;
        } else {
          params.append('mode', mode);
          window.location.href = `chat.html?${params.toString()}`;
        }
      }, 1200);
    }

    // ============================
    // EVENT LISTENERS
    // ============================
    // ============================
    // VIDEO POPUP
    // ============================
    function setupVideoPopup() {
      const brands = document.querySelectorAll('.brand');
      const overlay = document.getElementById('videoPopupOverlay');
      const closeBtn = document.getElementById('videoPopupClose');
      const video = document.getElementById('introVideo');

      if (brands.length > 0) {
        brands.forEach(brand => {
          brand.addEventListener('click', (e) => {
            e.preventDefault();
            openVideoPopup();
          });
        });
      }

      function openVideoPopup() {
        if (overlay && video) {
          overlay.classList.add('show');
          document.body.style.overflow = 'hidden';
          
          // Hide error message initially
          const errorMsg = document.getElementById('videoError');
          if (errorMsg) errorMsg.style.display = 'none';

          // Force reload to ensure fresh state
          video.load();
          video.currentTime = 0;
          video.muted = false;

          const playPromise = video.play();
          
          if (playPromise !== undefined) {
            playPromise.then(() => {
              console.log('Video started playing successfully');
            }).catch(error => {
              console.log('Autoplay prevented or failed:', error);
              // Fallback to muted autoplay
              video.muted = true;
              video.play().then(() => {
                console.log('Video playing muted');
              }).catch(e => {
                console.error('Muted playback also failed:', e);
                // Video remains paused, user can use controls
              });
            });
          }
        }
      }

      // Add error handling listeners
      if (video) {
        video.addEventListener('error', (e) => {
          console.error('Video error:', video.error);
          const errorMsg = document.getElementById('videoError');
          if (errorMsg) {
            errorMsg.style.display = 'block';
            // Add detail to the error message if possible
            const p = errorMsg.querySelector('p');
            if (p && video.error) {
              p.textContent = `Video Error: ${video.error.code} - ${video.error.message || 'Unknown error'}`;
            }
          }
        });
        
        video.addEventListener('stalled', () => console.log('Video stalled'));
        video.addEventListener('waiting', () => console.log('Video waiting for data'));
      }

      // Retry button logic
      const retryBtn = document.getElementById('retryVideoBtn');
      if (retryBtn && video) {
        retryBtn.addEventListener('click', () => {
          video.load();
          video.play();
          const errorMsg = document.getElementById('videoError');
          if (errorMsg) errorMsg.style.display = 'none';
        });
      }

      function closeVideoPopup() {
        if (overlay && video) {
          overlay.classList.remove('show');
          video.pause();
          video.currentTime = 0;
          document.body.style.overflow = '';
        }
      }

      if (closeBtn) {
        closeBtn.addEventListener('click', closeVideoPopup);
      }

      if (overlay) {
        overlay.addEventListener('click', (e) => {
          if (e.target === overlay) {
            closeVideoPopup();
          }
        });
      }

      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && overlay && overlay.classList.contains('show')) {
          closeVideoPopup();
        }
      });
    }

    // ============================
    // EVENT LISTENERS
    // ============================
    function setupEventListeners() {
      // Coin click handler
      document.querySelectorAll('.stat-pill.coins').forEach(pill => {
        pill.addEventListener('click', handleCoinClick);
      });
      
      // Chat cards
      document.getElementById('textChat')?.addEventListener('click', () => startChat('text'));
      document.getElementById('videoChat')?.addEventListener('click', () => startChat('video'));
      document.getElementById('groupChat')?.addEventListener('click', () => startChat('group'));
      
      // Interest input
      const interestInput = document.getElementById('interestInput');
      if (interestInput) {
        interestInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            if (addInterest(interestInput.value)) {
              interestInput.value = '';
              interestInput.focus();
            }
          }
        });
      }
      
      // Interest suggestions
      document.querySelectorAll('.suggestion').forEach(button => {
        button.addEventListener('click', function() {
          const interest = this.getAttribute('data-interest');
          if (interest && addInterest(interest)) {
            // Add click animation
            this.style.transform = 'scale(0.9)';
            setTimeout(() => {
              this.style.transform = '';
            }, 200);
          }
        });
      });
      
      // Notification bell
      const notificationBell = document.getElementById('notificationBell');
      if (notificationBell) {
        notificationBell.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleNotificationDropdown();
        });
      }
      
      // Clear all notifications button
      const clearAllBtn = document.getElementById('clearAllBtn');
      if (clearAllBtn) {
        clearAllBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          clearAllNotifications();
        });
      }
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        const dropdown = document.getElementById('notificationDropdown');
        const bell = document.getElementById('notificationBell');
        if (dropdown && bell && !dropdown.contains(e.target) && !bell.contains(e.target)) {
          if (appState.notificationDropdownOpen) {
            toggleNotificationDropdown();
          }
        }
      });
      
      // Footer links now use direct navigation via their href attributes
      // Monetization controls are managed in Admin Dashboard
      
      // Add hover effects to all interactive elements
      document.querySelectorAll('.chat-card, .feature-card, .step, .interest-tag, .suggestion').forEach(element => {
        element.addEventListener('mouseenter', () => {
          element.style.zIndex = '10';
        });
        
        element.addEventListener('mouseleave', () => {
          element.style.zIndex = '';
        });
      });
      // Mobile menu
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const mobileMenuClose = document.getElementById('mobileMenuClose');
      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', () => mobileMenu.classList.add('show'));
      }
      if (mobileMenuClose && mobileMenu) {
        mobileMenuClose.addEventListener('click', () => mobileMenu.classList.remove('show'));
      }
      if (mobileMenu) {
        mobileMenu.addEventListener('click', (e) => {
          if (e.target === mobileMenu) mobileMenu.classList.remove('show');
        });
      }
    }

    // ============================
    // INDEX POPUP ADS
    // ============================
    async function loadAdConfigForIndex() {
      try {
        const res = await fetch('/api/ads/config');
        const cfg = await res.json();
        return cfg || { enabled: false };
      } catch (_) {
        return { enabled: false };
      }
    }

    function createCardAd() {
      const el = document.createElement('div');
      el.className = 'mm-card-ad';
      el.innerHTML = `
        <div class="mm-ad-header">
          <div>Sponsored</div>
          <button class="mm-ad-close" aria-label="Close"></button>
        </div>
        <div class="mm-ad-body">
          <div class="mm-ad-thumb mm-shimmer"></div>
          <div>Promote your brand here. Nonintrusive, closable popup.</div>
        </div>
      `;
      const close = el.querySelector('.mm-ad-close');
      close.addEventListener('click', (e) => {
        e.stopPropagation();
        el.remove();
      });
      // Prevent ad clicks from triggering the card action
      el.addEventListener('click', (e) => e.stopPropagation());
      return el;
    }

    function injectIndexAds() {
      ['textChat','videoChat','groupChat'].forEach(id => {
        const card = document.getElementById(id);
        if (!card) return;
        // Avoid duplicates
        if (!card.querySelector('.mm-card-ad')) {
          const ad = createCardAd();
          card.appendChild(ad);
        }
      });
    }

    function injectInlineAdSlots() {
      const makeSlot = (text = 'Ad Placeholder  Your content here') => {
        const slot = document.createElement('div');
        slot.className = 'mm-inline-slot mm-shimmer';
        slot.textContent = text;
        return slot;
      };
      const chatButtons = document.querySelector('.chat-buttons');
      if (chatButtons && !chatButtons.nextElementSibling?.classList?.contains('mm-inline-slot')) {
        chatButtons.insertAdjacentElement('afterend', makeSlot());
      }
      const featuresGrid = document.querySelector('.features-grid');
      if (featuresGrid) {
        featuresGrid.insertAdjacentElement('beforebegin', makeSlot());
      }
      const footer = document.querySelector('footer');
      if (footer && !footer.previousElementSibling?.classList?.contains('mm-inline-slot')) {
        footer.insertAdjacentElement('beforebegin', makeSlot());
      }
    }

    function removeInlineAdSlots() {
      document.querySelectorAll('.mm-inline-slot').forEach(el => el.remove());
      document.querySelectorAll('.mm-card-ad').forEach(el => el.remove());
      document.getElementById('mm-footer-ad')?.remove();
      document.getElementById('mm-ad-popup')?.remove();
    }

    function applyAdEnablement(cfg) {
      const enabled = !!(cfg && cfg.enabled);
      if (enabled) {
        injectIndexAds();
        injectInlineAdSlots();
      } else {
        removeInlineAdSlots();
      }
    }

    // ============================
    // ADVANCED FEATURES
    // ============================
    function initializeAdvancedFeatures() {
      setupThemeToggle();
      setupScrollAnimations();
      setup3DTilt();
      setupTypingEffect();
      enhanceParticles();
      setupPreloader();
      setupScrollToTop();
      setupShimmerEffect();
    }

    function setupPreloader() {
      const preloader = document.getElementById('preloader');
      if (!preloader) return;
      // Hide as soon as DOM is ready to avoid long blocking on mobile
      document.addEventListener('DOMContentLoaded', () => {
        preloader.classList.add('hidden');
        setTimeout(() => preloader.remove(), 500);
      });
      // Fallback safety hide
      setTimeout(() => {
        if (preloader && !preloader.classList.contains('hidden')) {
          preloader.classList.add('hidden');
        }
      }, 1500);
    }

    function setupScrollToTop() {
      const btn = document.getElementById('scrollTopBtn');
      if (!btn) return;
      
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          btn.classList.add('visible');
        } else {
          btn.classList.remove('visible');
        }
      });
      
      btn.addEventListener('click', () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    }

    function setupShimmerEffect() {
      const brandText = document.querySelector('.brand-text');
      if (brandText) {
        brandText.classList.add('shimmer-text');
      }
    }

    function setupThemeToggle() {
      const toggleBtn = document.getElementById('themeToggle');
      const toggleBtnMobile = document.getElementById('themeToggleMobile');
      const savedTheme = localStorage.getItem('manaTheme') || 'dark';
      
      if (savedTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
        if (toggleBtn) toggleBtn.querySelector('span').textContent = '';
        if (toggleBtnMobile) toggleBtnMobile.querySelector('span').textContent = '';
      }

      if (toggleBtn) {
        toggleBtn.addEventListener('click', () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('manaTheme', newTheme);
          
          toggleBtn.querySelector('span').textContent = newTheme === 'light' ? '' : '';
          if (toggleBtnMobile) toggleBtnMobile.querySelector('span').textContent = newTheme === 'light' ? '' : '';
          
          // Animation
          toggleBtn.style.transform = 'rotate(360deg)';
          setTimeout(() => toggleBtn.style.transform = '', 300);
          
          showNotification(`Switched to ${newTheme} mode`, 'success');
        });
      }
      if (toggleBtnMobile) {
        toggleBtnMobile.addEventListener('click', () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentTheme === 'light' ? 'dark' : 'light';
          
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('manaTheme', newTheme);
          
          toggleBtnMobile.querySelector('span').textContent = newTheme === 'light' ? '' : '';
          if (toggleBtn) toggleBtn.querySelector('span').textContent = newTheme === 'light' ? '' : '';
          
          showNotification(`Switched to ${newTheme} mode`, 'success');
        });
      }
    }

    function setupScrollAnimations() {
      // Add class to sections
      const sections = document.querySelectorAll('.hero-section, .chat-section, .interests-section, .features-section, .steps-section, .safety-section');
      sections.forEach(section => {
        section.classList.add('reveal-on-scroll');
      });

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
          }
        });
      }, { threshold: 0.1 });

      sections.forEach(section => observer.observe(section));
    }

    function setup3DTilt() {
      const cards = document.querySelectorAll('.chat-card, .feature-card, .step');
      
      cards.forEach(card => {
        card.classList.add('tilt-card');
        
        card.addEventListener('mousemove', (e) => {
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const rotateX = (centerY - y) / 10;
          const rotateY = (x - centerX) / 10;
          
          card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
        });
        
        card.addEventListener('mouseleave', () => {
          card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
        });
      });
    }

    function setupTypingEffect() {
      const title = document.querySelector('.hero-title');
      if (!title) return;
      
      // Store original text if not already stored
      if (!title.getAttribute('data-original-text')) {
        title.setAttribute('data-original-text', title.textContent);
      }
      
      const text = title.getAttribute('data-original-text').trim();
      title.textContent = '';
      title.classList.add('typing-cursor');
      
      let i = 0;
      function type() {
        if (i < text.length) {
          title.textContent += text.charAt(i);
          i++;
          setTimeout(type, 50);
        } else {
          setTimeout(() => {
            title.classList.remove('typing-cursor');
          }, 1000);
        }
      }
      
      // Start after a delay
      setTimeout(type, 500);
    }

    function enhanceParticles() {
      const container = document.getElementById('particles');
      if (!container) return;
      
      // Add shooting stars occasionally
      setInterval(() => {
        const star = document.createElement('div');
        star.style.position = 'absolute';
        star.style.width = '2px';
        star.style.height = '2px';
        star.style.background = '#fff';
        star.style.boxShadow = '0 0 10px #fff, 0 0 20px #fff';
        star.style.top = Math.random() * 50 + '%';
        star.style.left = Math.random() * 100 + '%';
        star.style.opacity = '0';
        star.style.transform = 'rotate(-45deg) translateX(0)';
        star.style.transition = 'all 1s linear';
        
        container.appendChild(star);
        
        requestAnimationFrame(() => {
          star.style.opacity = '1';
          star.style.transform = 'rotate(-45deg) translateX(-200px)';
        });
        
        setTimeout(() => star.remove(), 1000);
      }, 3000);
    }
  </script>
</body>
</html>
